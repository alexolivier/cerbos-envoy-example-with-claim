# yaml-language-server: $schema=https://api.cerbos.dev/latest/cerbos/policy/v1/Policy.schema.json
apiVersion: api.cerbos.dev/v1
resourcePolicy:
  version: default
  resource: document
  rules:
    - name: allow-read-account-published-documents
      actions: [read]
      effect: EFFECT_ALLOW
      roles:
        - "user"
      condition:
        match:
          all:
            of:
              - expr: request.principal.attr.accountId in request.resource.attr.accountId
              - expr: request.resource.attr.status == "published"

    - name: allow-read-admin-documents
      actions: [read]
      effect: EFFECT_ALLOW
      roles:
        - "admin"
