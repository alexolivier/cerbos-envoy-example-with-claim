# yaml-language-server: $schema=https://api.cerbos.dev/latest/cerbos/policy/v1/Policy.schema.json
apiVersion: api.cerbos.dev/v1
derivedRoles:
  name: account_roles
  definitions:
    - name: account_member
      parentRoles:
        - user
      condition:
        match:
          expr: request.principal.attr.accountId in request.resource.attr.accountId
    - name: account_admin
      parentRoles:
        - admin
    - name: internal_service
      parentRoles:
        - service
